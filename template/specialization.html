{% extends "dashboardbase.html" %}
{% block title %}Specialization{% endblock %}

{% block content %}
  <h1>Specialization</h1>

  <style>
    /* Your button style */
    .btn-primary {
      background-color: #3498db;
      border: 2px solid #3498db;
      color: #fff;
      padding: 10px 20px;
      border-radius: 5px;
      font-size: 16px;
      cursor: pointer;
      transition: background-color 0.3s, color 0.3s;
    }

    .btn-primary:hover {
      background-color: #2980b9;
      border-color: #2980b9;
      color: #fff;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    
    /* Form container initially hidden */
    .form-container {
      display: none;
    }

    /* Style the form elements */
    .form-group {
      margin-bottom: 15px;
    }

    .form-group label {
      display: block;
      margin-bottom: 5px;
    }

    .form-group input[type="text"] {
      width: 100%;
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 5px;
    }

    .form-group .btn-submit {
      background-color: #2ecc71;
      color: #fff;
      padding: 10px 20px;
      border: none;
      border-radius: 5px;
      font-size: 16px;
      cursor: pointer;
      transition: background-color 0.3s, color 0.3s;
    }

    .form-group .btn-submit:hover {
      background-color: #27ae60;
    }
    table {
      width: 100%;
      border-collapse: collapse;
    }
    
    table, th, td {
      border: 1px solid #ccc;
    }
    
    th, td {
      padding: 8px;
      text-align: left;
    }
    /* Style the "Update" and "Delete" links with more specific selectors */
    table a.update-link, table a.delete-link {
      text-decoration: none;
      background-color: #2ecc71;
      color: #fff;
      padding: 5px 10px;
      border-radius: 5px;
      margin-right: 5px;
      transition: background-color 0.3s, color 0.3s;
    }

    table a.update-link:hover, table a.delete-link:hover {
      background-color: #27ae60;
    }
  </style>

  <button id="showFormButton" class="btn btn-primary">Add Specialization</button>

 <div class="form-container">
    <form method="post" action="{% if specialization.id %}{% url 'update_specialization' specialization.id %}{% else %}{% url 'create_specialization' %}{% endif %}" onsubmit="return validateUpdateForm()">
      {% csrf_token %}
      <div class="form-group">
        <label for="specialization">Specialization:</label>
        <input type="text" id="specialization" name="specialization">
        <span id="specializationError" class="error"></span>
      </div>
      <div class="form-group">
        <label for="description">Description:</label>
        <input type="text" id="description" name="description">
        <span id="descriptionError" class="error"></span>
      </div>
      <div class="form-group">
        <button type="submit" class="btn btn-submit">Submit</button>
      </div>
    </form>
  </div>



  <h2>Entries</h2>
  <table class="table" border="1px">
    <thead>
      <tr>
          <th>SI No</th>
          <th>Type</th>
          <th>Description</th>
          <th>Update</th>
          <th>Delete</th>
      </tr>
  </thead>
  <tbody>
    {% for specialization in specializations %}
        <tr>
            <td>{{ forloop.counter }}</td> <!-- Add this line to display the serial number -->
            <td>{{ specialization.name }}</td>
            <td>{{ specialization.description }}</td>
            <td><a href="{% url 'update_specialization' specialization.id %}" style="text-decoration: none; background-color: #2ecc71; color: #fff; padding: 5px 10px; border-radius: 5px; margin-right: 5px;">Update</a></td>
            <td><a href="{% url 'delete_specialization' specialization.id %}" style="text-decoration: none; background-color: #2ecc71; color: #fff; padding: 5px 10px; border-radius: 5px; margin-right: 5px;">Delete</a></td>
        </tr>
    {% endfor %}
  </tbody>
  </table>

   <script>
    function validateUpdateForm() {
      var specializationInput = document.getElementById('specialization');
      var descriptionInput = document.getElementById('description');
      var specializationError = document.getElementById('specializationError');
      var descriptionError = document.getElementById('descriptionError');
  
      specializationError.textContent = "";
      descriptionError.textContent = "";
  
      // Regular expression to allow only characters (no special characters or numbers)
      var onlyCharactersRegex = /^[A-Za-z]+$/;
  
      if (specializationInput.value.trim() === "") {
        specializationError.textContent = "Specialization cannot be empty";
        specializationError.style.color = "red"; // Set error message color to red
        return false;
      } else if (!onlyCharactersRegex.test(specializationInput.value.trim())) {
        specializationError.textContent = "Specialization should only contain characters";
        specializationError.style.color = "red";
        return false;
      }
  
      if (descriptionInput.value.trim() === "") {
        descriptionError.textContent = "Description cannot be empty";
        descriptionError.style.color = "red"; // Set error message color to red
        return false;
      } else if (!onlyCharactersRegex.test(descriptionInput.value.trim())) {
        descriptionError.textContent = "Description should only contain characters";
        descriptionError.style.color = "red";
        return false;
      }
  
      return true; // Form is valid
    }
   

    // Get references to the button and form container
    const showFormButton = document.getElementById("showFormButton");
    const formContainer = document.querySelector(".form-container");

    // Add a click event listener to the button
    showFormButton.addEventListener("click", function () {
      // Toggle the visibility of the form container
      formContainer.style.display = formContainer.style.display === "none" ? "block" : "none";
    });
    const updateLink = document.getElementById("updateLink");
    updateLink.addEventListener("click", function (event) {
      // Prevent the default behavior of the link
      event.preventDefault();
    
      // Create a form dynamically for the update
      const updateForm = document.getElementById("updateForm");
      const specializationInput = updateForm.querySelector("#specialization");
      const descriptionInput = updateForm.querySelector("#description");
      const specializationError = document.getElementById("specializationError");
      const descriptionError = document.getElementById("descriptionError");
    
      // Clear existing error messages
      specializationError.textContent = "";
      descriptionError.textContent = "";
    
      // Set the initial values for specialization and description if they pass validation
      if (validateUpdateForm()) {
        specializationInput.value = '{{ specialization.name }}';
        descriptionInput.value = '{{ specialization.description }}';
    
        // Toggle the visibility of the form container
        formContainer.style.display =
          formContainer.style.display === "none" ? "block" : "none";
      }
    });
    

  </script>
{% endblock %}